<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gestión de Tareas - Versión Simple</title>
  <style>
    :root{
      --bg:#f1f5f9;
      --sidebar:#0f1724;
      --card:#ffffff;
      --primary:#3b82f6;
      --muted:#64748b;
      --accent:#0ea5e9;
      --danger:#ef4444;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Inter, "Segoe UI", Roboto, Arial, sans-serif;
      background:var(--bg);
      color:#0b1220;
    }
    .app{
      display:grid;
      grid-template-columns:250px 1fr;
      min-height:100vh;
    }

    /* Sidebar ancho 250px */
    .sidebar{
      background:linear-gradient(180deg, var(--sidebar), #14233a);
      color:#fff;
      padding:24px;
    }
    .brand{font-weight:700; letter-spacing:0.4px; margin-bottom:18px; font-size:18px}
    .nav{list-style:none; padding:0; margin:20px 0}
    .nav li{margin:10px 0; padding:10px; border-radius:8px; cursor:pointer; color:#cfe8ff}
    .nav li.active, .nav li:hover{background:rgba(255,255,255,0.06); color:#fff}

    header{
      display:flex; align-items:center; justify-content:space-between;
      padding:18px 24px; background:transparent;
      border-bottom:1px solid rgba(15,20,36,0.05);
    }
    main{
      padding:24px;
    }
    .container{
      max-width:1100px; margin:0 auto;
    }
    .card{
      background:var(--card); border-radius:12px; padding:16px; box-shadow: 0 4px 12px rgba(2,6,23,0.06); margin-bottom:18px;
    }
    form .row{display:flex; gap:12px; margin-bottom:12px}
    .col{flex:1}
    label{display:block; font-size:13px; color:var(--muted); margin-bottom:6px}
    input[type="text"], select, textarea, input[type="number"]{
      width:100%; padding:10px 12px; border-radius:8px; border:1px solid #e6eef7; font-size:14px;
      background:#fbfdff;
    }
    textarea{min-height:72px; resize:vertical}
    .btn{display:inline-block; padding:10px 14px; border-radius:8px; text-decoration:none; cursor:pointer; border:0; font-weight:600}
    .btn-primary{background:var(--primary); color:#fff}
    .btn-ghost{background:transparent; color:var(--muted); border:1px solid #e6eef7}
    table{width:100%; border-collapse:collapse; font-size:14px}
    thead th{ text-align:left; padding:10px 8px; color:var(--muted); font-weight:700}
    tbody td{padding:10px 8px; border-top:1px solid #f1f5f9}
    .small{font-size:13px; color:var(--muted)}
    .pill{display:inline-block; padding:6px 8px; border-radius:999px; font-size:12px; background:#eef2ff; color:#3730a3}
    .actions button{margin-right:6px}
    .empty{padding:30px; text-align:center; color:var(--muted)}
    @media(max-width:880px){
      .app{grid-template-columns:1fr}
      .sidebar{display:flex; gap:10px; overflow:auto}
      .brand{display:none}
    }
  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand">Koru — Gestión de Tareas</div>
      <ul class="nav">
        <li class="active" data-section="tareas">Tareas</li>
        <li data-section="proyectos">Proyectos</li>
        <li data-section="empleados">Empleados</li>
      </ul>
      <div style="margin-top:auto; font-size:13px; color:#cfe8ff">Usuario: Coordinador</div>
    </aside>

    <div>
      <header>
        <div class="container" style="display:flex; gap:12px; align-items:center; width:100%">
          <h2 style="margin:0">Panel de Tareas</h2>
          <div class="small" style="margin-left:12px">Centraliza los avances de tus empleados</div>
        </div>
      </header>

      <main>
        <div class="container">
          <section id="section-tareas" class="card">
            <h3>Registrar tarea</h3>
            <form id="taskForm">
              <div class="row">
                <div class="col">
                  <label for="employee">Empleado</label>
                  <input id="employee" required type="text" placeholder="Nombre del empleado" />
                </div>
                <div class="col">
                  <label for="project">Proyecto</label>
                  <input id="project" required type="text" placeholder="Nombre del proyecto" />
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <label for="description">Descripción</label>
                  <textarea id="description" placeholder="Descripción breve de la actividad"></textarea>
                </div>
                <div style="width:180px">
                  <label for="duration">Duración (hrs)</label>
                  <input id="duration" required type="number" min="0" step="0.25" value="1" />
                </div>
              </div>
              <div style="display:flex; gap:8px; justify-content:flex-end">
                <button type="button" class="btn btn-ghost" id="resetBtn">Limpiar</button>
                <button type="submit" class="btn btn-primary" id="saveBtn">Agregar tarea</button>
              </div>
            </form>
          </section>

          <section class="card">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <h3 style="margin:0">Tareas registradas</h3>
              <div>
                <label class="small">Filtrar por proyecto</label>
                <input id="filterProject" type="text" placeholder="Nombre proyecto" style="padding:8px 10px; border-radius:8px; border:1px solid #e6eef7" />
              </div>
            </div>

            <div id="tasksList" style="margin-top:12px"></div>
          </section>
        </div>
      </main>
    </div>
  </div>

  <script>
    // Datos en memoria
    let tasks = [];
    let editId = null;

    // Elementos
    const taskForm = document.getElementById('taskForm');
    const employeeInput = document.getElementById('employee');
    const projectInput = document.getElementById('project');
    const descriptionInput = document.getElementById('description');
    const durationInput = document.getElementById('duration');
    const tasksList = document.getElementById('tasksList');
    const filterProject = document.getElementById('filterProject');
    const resetBtn = document.getElementById('resetBtn');

    // Handlers
    taskForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const payload = {
        id: editId || Date.now().toString(),
        employee: employeeInput.value.trim(),
        project: projectInput.value.trim(),
        description: descriptionInput.value.trim(),
        duration: Number(durationInput.value),
        createdAt: new Date().toISOString()
      };

      if(editId){
        // editar en memoria
        tasks = tasks.map(t => t.id === editId ? payload : t);
        editId = null;
        document.getElementById('saveBtn').textContent = 'Agregar tarea';
      } else {
        tasks.push(payload);
      }

      // Aquí se podría llamar a fetch('/api/tasks', {method:'POST', body: JSON.stringify(payload)})
      renderTasks();
      taskForm.reset();
      durationInput.value = 1;
    });

    resetBtn.addEventListener('click', () => {
      editId = null; taskForm.reset(); durationInput.value = 1; document.getElementById('saveBtn').textContent = 'Agregar tarea';
    });

    filterProject.addEventListener('input', renderTasks);

    function renderTasks(){
      const filter = filterProject.value.trim().toLowerCase();
      if(tasks.length === 0){
        tasksList.innerHTML = '<div class="empty">No hay tareas registradas.</div>';
        return;
      }
      const filtered = filter ? tasks.filter(t => t.project.toLowerCase().includes(filter)) : tasks;
      let html = '<table><thead><tr><th>Tarea</th><th>Empleado</th><th>Proyecto</th><th>Duración (hrs)</th><th>Creada</th><th></th></tr></thead><tbody>';
      for(const t of filtered){
        html += `<tr>
          <td><div class="small">${escapeHtml(t.description || '-')}</div></td>
          <td>${escapeHtml(t.employee)}</td>
          <td><span class="pill">${escapeHtml(t.project)}</span></td>
          <td>${t.duration}</td>
          <td class="small">${new Date(t.createdAt).toLocaleString()}</td>
          <td class="actions">
            <button class="btn btn-ghost" onclick="editTask('${t.id}')">Editar</button>
            <button class="btn" style="background:var(--danger); color:#fff;" onclick="deleteTask('${t.id}')">Eliminar</button>
          </td>
        </tr>`;
      }
      html += '</tbody></table>';
      tasksList.innerHTML = html;
    }

    function editTask(id){
      const t = tasks.find(x => x.id === id);
      if(!t) return alert('Registro no encontrado');
      employeeInput.value = t.employee;
      projectInput.value = t.project;
      descriptionInput.value = t.description;
      durationInput.value = t.duration;
      editId = id;
      document.getElementById('saveBtn').textContent = 'Guardar cambios';
      window.scrollTo({top:0, behavior:'smooth'});
    }

    function deleteTask(id){
      if(!confirm('¿Eliminar esta tarea?')) return;
      tasks = tasks.filter(t => t.id !== id);
      // aquí fetch('/api/tasks/'+id, {method:'DELETE'})
      renderTasks();
    }

    function escapeHtml(unsafe){
      return String(unsafe).replace(/[&<>"']/g, (m) => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#039;"}[m]));
    }

    // Datos demo (opcional)
    tasks.push({
      id: Date.now().toString(),
      employee: 'María López',
      project: 'Integración API',
      description: 'Configuración y pruebas iniciales',
      duration: 3,
      createdAt: new Date().toISOString()
    });

    renderTasks();
  </script>
</body>
</html>
